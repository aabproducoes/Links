<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Your Resume</title>
  <meta
    name="description"
    content="Antonio Augusto Barbaro's resume. Check out qualifications, social links, and contact information."
  />
  <meta
    name="keywords"
    content="Resume, Antonio Augusto Barbaro, Qualifications, Social Links, Contact Information"
  />
  <meta name="author" content="Antonio Augusto Barbaro" />

  <!-- Import Google Fonts -->
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;700&family=Poppins:wght@400;600&display=swap"
    rel="stylesheet"
  />

  <style>
    /* [Your existing CSS styles here] */
    /* ... */
  </style>
</head>
<body>
  <!-- Tech Background -->
  <div class="tech-bg"></div>

  <!-- Language Selector -->
  <div class="language-selector">
    <label for="language">Select Language: </label>
    <select id="language">
      <option value="en">English</option>
      <option value="pt">Português</option>
    </select>
  </div>

  <!-- Rotated Menu with Profile Picture -->
  <div class="menu" id="menu">
    <img
      src="./images/292440780_2225688030932761_1836941331334930994_n.webp"
      alt="Profile Picture"
      class="profile-picture"
    />

    <div class="menu-item" data-section="profile">Profile</div>
    <div class="menu-item" data-section="socialLinks">Social Links</div>
    <div class="menu-item" data-section="friendlySites">Friendly Sites</div>
    <div class="menu-item" data-section="certifications">Certifications</div>
    <div class="menu-item" data-section="contact">Contact</div>
  </div>

  <!-- Main Content Area -->
  <div class="main-content">
    <!-- Center Section -->
    <div class="center-section" id="centerSection">
      <!-- Profile Section -->
      <div id="profile" class="content-section">
        <h2>Profile</h2>
        <!-- Add your profile content here -->
        <h2 id="knowledge-title">Knowledge</h2>
        <ul class="knowledge-list" id="knowledge-list"></ul>
      </div>

      <!-- Social Links Section -->
      <div id="socialLinks" class="content-section" style="display: none;">
        <h2>Social Links & Projects</h2>
        <ul class="social-links">
          <li><a href="https://www.facebook.com/antonio.augusto.barbaro" class="social-link">Facebook</a></li>
          <li><a href="https://twitter.com/aabproducoes" class="social-link">Twitter</a></li>
          <li><a href="https://www.instagram.com/aabproducoes/" class="social-link">Instagram</a></li>
          <li>
            <a href="./blender-projects.html" class="social-link">Blender Projects</a>
            <ul class="project-links">
              <li><a href="./gimp-projects.html" class="social-link">Gimp Projects</a></li>
              <li><a href="./blender-animations.html" class="social-link">Blender Animation</a></li>
            </ul>
          </li>
        </ul>
      </div>

      <!-- Friendly Sites Section -->
      <div id="friendlySites" class="content-section" style="display: none;">
        <h2>Friendly Sites</h2>
        <ul class="friendly-sites">
          <li>
            <a href="https://aabproducoes.github.io/NewTab/" class="social-link">New Tab Replacement</a>
          </li>
          <li>
            <a href="#" class="social-link" id="animatedBackgroundLink">Animated Background</a>
          </li>
        </ul>
      </div>

      <!-- Certifications Section -->
      <div id="certifications" class="content-section" style="display: none;">
        <h2>Certifications</h2>
        <ul class="certifications-list" id="certifications-list"></ul>
      </div>

      <!-- Contact Section -->
      <div id="contact" class="content-section" style="display: none;">
        <h2>Contact</h2>
        <p><a href="https://wa.me/54984181968" class="social-link" id="whatsappLink">WhatsApp: 54984181968</a></p>
        <p><a href="mailto:aaugusto444@gmail.com" class="social-link" id="emailLink">Email: aaugusto444@gmail.com</a></p>
      </div>
    </div>
  </div>

  <!-- Lightning Effect Canvas -->
  <canvas id="lightningCanvas"></canvas>

  <!-- Lightning Effect Script -->
  <script>
    // [Your existing lightning effect JavaScript here]
    // ...
  </script>

  <!-- PDF.js Library -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>

  <!-- Main Script -->
  <script>
    let selectedLanguage = 'en';
    const MAX_CERTIFICATIONS = 1; // Set this to 1 to load only one certificate

    window.addEventListener('DOMContentLoaded', () => {
      initializeLanguageSelector();
      setupMenu();
      fetchTranslations();
      fetchKnowledgeList();
      fetchCertificationsList();
      showSection('profile'); // Show the profile section by default
    });

    function initializeLanguageSelector() {
      const languageSelect = document.getElementById("language");
      if (localStorage.getItem('selectedLanguage')) {
        selectedLanguage = localStorage.getItem('selectedLanguage');
        languageSelect.value = selectedLanguage;
      }
      languageSelect.addEventListener('change', () => {
        selectedLanguage = languageSelect.value;
        localStorage.setItem('selectedLanguage', selectedLanguage);
        changeLanguage();
      });
    }

    function changeLanguage() {
      fetchTranslations();
      fetchKnowledgeList();
      fetchCertificationsList();
    }

    function fetchTranslations() {
      const translations = {
        "en": {
          "socialLinks": "Social Links & Projects",
          "friendlySites": "Friendly Sites",
          "certifications": "Certifications",
          "contact": "Contact",
          "knowledge": "Knowledge",
          "whatsapp": "WhatsApp",
          "email": "Email",
          "facebook": "Facebook",
          "twitter": "Twitter",
          "instagram": "Instagram",
          "blenderprojects": "Blender Projects",
          "gimpprojects": "Gimp Projects",
          "blenderanimation": "Blender Animation",
          "newtabreplacement": "New Tab Replacement",
          "animatedbackground": "Animated Background",
          "profile": "Profile"
        },
        "pt": {
          "socialLinks": "Redes Sociais & Projetos",
          "friendlySites": "Sites Amigos",
          "certifications": "Certificações",
          "contact": "Contato",
          "knowledge": "Conhecimentos",
          "whatsapp": "WhatsApp",
          "email": "Email",
          "facebook": "Facebook",
          "twitter": "Twitter",
          "instagram": "Instagram",
          "blenderprojects": "Projetos Blender",
          "gimpprojects": "Projetos Gimp",
          "blenderanimation": "Animação Blender",
          "newtabreplacement": "Substituição da Nova Guia",
          "animatedbackground": "Fundo Animado",
          "profile": "Perfil"
        }
      };

      const data = translations[selectedLanguage] || translations["en"];

      // Update section titles
      document.querySelectorAll('.content-section h2').forEach(el => {
        const id = el.parentElement.id;
        if (data[id]) {
          el.innerText = data[id];
        }
      });

      // Update menu items
      document.querySelectorAll('.menu-item').forEach(el => {
        const section = el.getAttribute('data-section');
        if (data[section]) {
          el.innerText = data[section];
        }
      });

      // Update project links
      const projectLinks = document.querySelectorAll('.project-links a');
      projectLinks.forEach(link => {
        const key = link.textContent.replace(/\s+/g, '').toLowerCase();
        if (data[key]) {
          link.textContent = data[key];
        }
      });

      // Update social links
      const socialLinks = document.querySelectorAll('.social-links > li > a');
      socialLinks.forEach(link => {
        const key = link.textContent.replace(/\s+/g, '').toLowerCase();
        if (data[key]) {
          link.textContent = data[key];
        }
      });

      // Update friendly sites links
      const friendlySitesLinks = document.querySelectorAll('.friendly-sites a');
      friendlySitesLinks.forEach(link => {
        const key = link.textContent.replace(/\s+/g, '').toLowerCase();
        if (data[key]) {
          link.textContent = data[key];
        }
      });

      // Update Contact links
      const whatsappLink = document.getElementById('whatsappLink');
      whatsappLink.textContent = `${data.whatsapp}: 54984181968`;

      const emailLink = document.getElementById('emailLink');
      emailLink.textContent = `${data.email}: aaugusto444@gmail.com`;
    }

    function fetchKnowledgeList() {
      fetch('./KnowledgeList/KnowledgeList.txt')
        .then(response => response.text())
        .then(data => {
          const knowledgeList = document.getElementById("knowledge-list");
          if (!knowledgeList) {
            console.error('Knowledge list element not found');
            return;
          }
          knowledgeList.innerHTML = '';

          const lines = data.split('\n').filter(line => line.trim() !== '');
          lines.forEach(line => {
            const [enText, ptText] = line.split('||');
            const listItem = document.createElement('li');
            listItem.textContent = selectedLanguage === 'pt' ? (ptText ? ptText.trim() : '') : (enText ? enText.trim() : '');
            knowledgeList.appendChild(listItem);
          });
        })
        .catch(error => console.error('Error loading knowledge list:', error));
    }

    async function fetchCertificationsList() {
      try {
        const response = await fetch('./Certificados/CertificadosList.txt');
        if (!response.ok) {
          throw new Error(`Failed to fetch certifications list: ${response.status} ${response.statusText}`);
        }

        const data = await response.text();
        const certificationsList = document.getElementById("certifications-list");
        if (!certificationsList) {
          console.error('Certifications list element not found');
          return;
        }
        certificationsList.innerHTML = '';

        const lines = data.split('\n').filter(line => line.trim() !== '');
        console.log(`Total certifications found: ${lines.length}`);

        // Limit the number of loaded certifications
        const limitedLines = lines.slice(0, MAX_CERTIFICATIONS);
        console.log(`Loading the first ${MAX_CERTIFICATIONS} certification(s).`);

        limitedLines.forEach((line, index) => {
          console.log(`Processing line ${index + 1}: ${line}`);
          const [filePart, titlePart] = line.split(':');
          if (filePart && titlePart) {
            const file = filePart.trim().replace(/["']/g, '');
            const titles = titlePart.split('||');

            const enTitle = (titles[0] && titles[0].trim()) || "Untitled Certification";
            const ptTitle = (titles[1] && titles[1].trim()) || "Certificação Sem Título";

            const listItem = document.createElement('li');

            // Certification Title
            const certTitle = document.createElement('div');
            certTitle.classList.add('cert-title');
            certTitle.textContent = selectedLanguage === 'pt' ? ptTitle : enTitle;

            // PDF Canvas
            const pdfCanvas = document.createElement('canvas');
            pdfCanvas.classList.add('pdf-canvas');
            pdfCanvas.id = `pdf-canvas-${file}`;

            listItem.appendChild(certTitle);
            listItem.appendChild(pdfCanvas);
            certificationsList.appendChild(listItem);

            // Render the first page of the PDF
            renderFirstPage(`./Certificados/${file}`, pdfCanvas.id);
          } else {
            console.warn(`Line "${line}" is not properly formatted.`);
          }
        });

        if (limitedLines.length === 0) {
          certificationsList.innerHTML = '<li>No certifications available.</li>';
          console.warn('No certifications to display.');
        }

      } catch (error) {
        console.error('Error loading certifications list:', error);
        alert('An error occurred while loading the certifications list. Please try again later.');
      }
    }

    function renderFirstPage(pdfUrl, canvasId) {
      const canvas = document.getElementById(canvasId);
      const context = canvas.getContext('2d');

      if (!canvas) {
        console.error(`Canvas with ID ${canvasId} not found.`);
        return;
      }

      pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
        console.log(`PDF loaded: ${pdfUrl}`);
        return pdf.getPage(1);
      }).then(page => {
        console.log(`Rendering page 1 of ${pdfUrl}`);
        const scale = 1.5;
        const viewport = page.getViewport({ scale });

        canvas.width = viewport.width;
        canvas.height = viewport.height;

        const renderContext = {
          canvasContext: context,
          viewport: viewport
        };
        return page.render(renderContext).promise;
      }).then(() => {
        console.log(`Page rendered successfully for ${pdfUrl}`);
      }).catch(error => {
        console.error(`Error rendering PDF ${pdfUrl}:`, error);
      });
    }

    function setupMenu() {
      const menuItems = document.querySelectorAll('.menu-item');
      menuItems.forEach(item => {
        item.addEventListener('click', () => {
          menuItems.forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          const sectionId = item.getAttribute('data-section');
          showSection(sectionId);
        });
      });
    }

    function showSection(sectionId) {
      const sections = document.querySelectorAll('.content-section');
      sections.forEach(section => {
        section.style.display = section.id === sectionId ? 'block' : 'none';
      });
    }
  </script>
</body>
</html>
